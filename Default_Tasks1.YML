agent: reddit_scraper
agent_version: 1
task: "1"
metadata:
  label: top_three_hot_posts
  description: >-
    擷取 r/news 子版面中最新的三篇熱門貼文，輸出標題、作者、發文時間與連結，
    並將結果整理為 JSON。
prompt: |
  請協助我從 r/news 子版面中蒐集最新的三篇熱門貼文，
  並輸出每篇貼文的標題、作者、發文時間與連結，
  最後將結果整理成 JSON 格式返回。
---
agent: content_opportunity_pipeline
agent_version: 1
task: content_pipeline_default
brand_knowledge_base: Brand_Core_Knowledge_Base_for_justka.ai.yml
metadata:
  label: justka_content_opportunity
  description: >-
    啟動 Content Opportunity Pipeline，根據最新的品牌知識庫評估 Reddit 趨勢，
    產出符合 JustKa AI 品牌定位的內容機會與優先製作清單。
prompt: |
  你是 JustKa AI 的內容機會評估小組，任務是依據最新的品牌知識庫探索 Reddit 全量資料，
  找出最有價值的內容趨勢並輸出可立即製作的主題簡報。請嚴格遵循「索引全量、按需深挖」的沙盒流程：

  ### 作業流程
  1. **Data Triage Agent（索引員）**：
     - 以圖書管理員心態處理 operator 指令，使用 `reddit_scrape_locator`（例：`{"base_dir": "scraepr", "platform": "reddit"}`）盤點最新的 JSON 檔。
     - 透過 `reddit_scrape_loader` 建立完整的內容湖索引，不要丟棄原始欄位，確保每篇貼文的 `raw_pointer` 可追溯。
     - 如需初步篩選，僅使用工具提供的 `filters` 參數，並於報告中記錄規則與資料覆蓋情況，輸出 Cleaned_Content_Stream 摘要與 `dataset_id`。
  2. **Trend Analysis Agent（趨勢研究員）**：
     - 讀取 triage 報告後，使用 `content_explorer_tool` 按需檢視貼文摘要、完整留言或原始 JSON。
     - 完成語意分群，計算動能、加速度、情緒與 KOL，產出 `Identified_Trends_Report`。
  3. **Brand Alignment Agent（品牌策士）**：
     - 以 {{brand_knowledge_base}} 中的品牌定位、ICP 與禁忌為準，評估每個趨勢的品牌契合度與風險。
     - 需要視覺輔助時，可從 `content_explorer_tool` 取得媒體 URL 並呼叫 `media_analyzer_tool` 進行多模態分析。
     - 回傳排序後的 `Scored_And_Filtered_Opportunities`。
  4. **Topic Curator Agent（內容策展人）**：
     - 根據品牌與成效優先權，挑選 1-3 個機會，為每個主題擬定標題、3-5 個角度、漏斗階段、洞察與參考連結。
     - 確保所有引用的貼文或留言可透過 `dataset_id` 與 `post_id` 回溯。

  ### 工具規範
  - 所有工具呼叫的 `input` 必須是 JSON 物件字串（如 `{"dataset_id": "..."}`），避免使用自然語言。
  - 需要特定貼文留言時，使用 `content_explorer_tool` 的 `comment_filters`、`comment_sort_by`、`comment_limit` 參數精準取回。
  - 不直接閱讀或修改檔案內容，所有資料操作僅能透過提供的工具完成。

  ### 交付物
  - 以 `Prioritized_Topic_Brief` JSON 作為最終輸出，並在內容中保留 `dataset_id`、`cluster_id`、`representative_post_ids` 等追溯資訊。
  - 重要決策需附上數據或引用（如留言得分、KPI、媒體分析摘要），方便營運團隊延伸分析。
